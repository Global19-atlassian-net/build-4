build_run:
  config:
    build_id: ...
    commit_sha: ...
    tag_version: ...
  spec: ...


build_spec:
  config:
    repo_org: solo-io
    repo_name: sm-marketplace
    output_directory: _output
    version_var: github.com/solo-io/sm-marketplace/services/internal/version.Version
    gcloud:
      project_id: gloo-ee
      decrypt_key: build-key
      decrypt_keyring: build
      helm_chart_bucket: sm-marketplace-helm
    container_registries:
      - base_url: quay.io/solo-io
        release_only: true
        quay:
          encrypted_token: CiQAwdWthifvdUjpVHAln3ZIz4WljWx6qLt8E4yJArmrU4/1HQoSaQD5SXFIeMulT7DxGdwW0L9R+gA0SATR05xpTz7JS9LXJK+4iYPlFvVPs7O3DYee2YPJoF7o44vJ94+AyuMLQucS6BhHXQ0t//GvQWaFvdcTO4qH5HYgGQSrRY0a4E3l+4q6/M4da2m98Q==
      - gcr: {}
    github_encrypted_token: CiQAwdWthrSJ1uI5Ao/LnmX8OzXmA5TNCtDpeV6JdNouaGh5vpwSUQD5SXFIkCBvnu/wYDSGwgWNJaQV75wP/kDephn5GGuGCe0EGFXXE54zyH8iHRL45Uq0s39SoHEyYoZXF2Qla8IbKGAKswPRViYSChPthQILdA==
  checks:
    # TODO: not very fleshed out
    - solo_kit_generation:
        entrypoint: make generated-code
    - code_generation:
        entrypoint: make generated-ui
    - check_format: {}
    - check_spelling: {}
  manifests:
    - helm:
        name: sm-marketplace
        upload_yaml_to_github: true
  compile:
    go_compile:
    - name: smm-apiserver
      entrypoint: services/apiserver/cmd/main.go
      platforms: ["linux"]
      upload_to_github: false
    - name: smm-operator
      entrypoint: services/operator/cmd/main.go
      platforms: ["linux"]
      upload_to_github: false
    yarn_compile:
    - directory: ui
  containers:
    - name: smm-operator
      docker_file: services/operator/cmd/Dockerfile
    - name: smm-apiserver
      docker_file: services/apiserver/cmd/Dockerfile
    - name: smm-envoy
      docker_file: envoy/Dockerfile
    - name: smm-ui
      docker_file: ui/Dockerfile
  test_runs:
    - args: ['-r']
      env:
        # TODO: something about kube

  docs: {}
  distribution: {}





